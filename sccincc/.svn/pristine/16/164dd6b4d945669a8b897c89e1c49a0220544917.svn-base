
<div class="container-fluid"><<%= tag%>if(msg!=null){<%= tag%>>
<div class="alert alert-block">
<button type="button" class="close" data-dismiss="alert">&times;</button>
<h4>注意!</h4>
<<%= tag%>= util.inspect(msg,false,null)<%= tag%>></div>
<<%= tag%>}<%= tag%>>

<div class="container-fluid">

<div class="row-fluid sortable">
<div class="box span12">
<div class="box-content">
<form class="form-horizontal" method="POST">
<div><a href="/<%= mod.views.name%>/" class="btn btn-small
btn-primary"> <i class="icon-chevron-left icon-white"></i>列表</a></div>
<fieldset><legend><%= mod.views.memo%></legend> <% for(var
inst in mod.cloums){%> <% if(!mod.cloums[inst].create){continue;}%> <%
if(mod.cloums[inst].input.type=='hidden'){%> <input type="hidden" id="<%=
inst%>" name="<%= inst%>" value="<<%= tag%> if(inst!=null){<%=
tag%>><<%= tag%>= inst.<%= inst%> <%= tag%>><<%= tag%> }<%= tag%>>" />
<%continue;}%>
<div class="control-group<<%= tag%>if(msg!=null && msg.<%=
inst%>!=null){<%= tag%>>error<<%= tag%>}<%= tag%>>"> <label
	class="control-label" for="<%= inst%>"><%=
mod.cloums[inst].name %> </label>
<div class="controls"><%
if(mod.cloums[inst].input.type=='text'){%> <input type="text"
	class="span6" id="<%= inst%>" name="<%= inst%>" value="<<%=
tag%> if(inst!=null){<%= tag%>><<%= tag%>= inst.<%= inst%> <%=
tag%>><<%= tag%> }<%= tag%>>" /> <span class="help-inline"><<%=
tag%>if(msg!=null && msg.<%= inst%>!=null){<%= tag%>><<%= tag%>= msg.<%=
inst%><%= tag%>><<%= tag%>}<%= tag%>></span> <%}%> <%
if(mod.cloums[inst].input.type=='password'){%> <input type="password"
	class="span6" id="<%= inst%>" name="<%= inst%>" /> <span
	class="help-inline"><<%= tag%>if(msg!=null && msg.<%=
inst%>!=null){<%= tag%>><<%= tag%>= msg.<%= inst%><%= tag%>><<%=
tag%>}else{<%= tag%>>密码不能少于8位<<%= tag%>}<%= tag%>></span> <input
	type="password" class="span6" id="<%= inst%>_ag" name="<%=
inst%>_ag" > <span class="help-inline">密码输入确认</span> <%}%> <%
if(mod.cloums[inst].input.type=='date'){%> <input type="text"
	class="input-xlarge datepicker" id="<%= inst%>" name="<%=
inst%>" value="<<%= tag%> if(inst!=null){<%= tag%>><<%= tag%>= inst.<%=
inst%> <%= tag%>> <<%= tag%> }<%= tag%>>" /> <span class="help-inline"><<%=
tag%>if(msg!=null && msg.<%= inst%>!=null){<%= tag%>><<%= tag%>= msg.<%=
inst%><%= tag%>><<%= tag%>}<%= tag%>></span> <%}%> <%
if(mod.cloums[inst].input.type=='file'){%> <input type="file"
	class="input-file uniform_on" id="<%= inst%>" name="<%= inst%>"
> <span class="help-inline"><<%= tag%>if(msg!=null && msg.<%=
inst%>!=null){<%= tag%>><<%= tag%>= msg.<%= inst%><%= tag%>><<%=
tag%>}<%= tag%>></span> <%}%> <% if(mod.cloums[inst].input.type=='textarea'){%>
<textarea class="autogrow" id="<%= inst%>" name="<%= inst%>" ><<%= tag%> if(inst!=null){<%= tag%>><<%= tag%>= inst.<%= inst%><%= tag%>><<%= tag%>}<%= tag%>></textarea>
<span class="help-inline"><<%= tag%>if(msg!=null && msg.<%=
inst%>!=null){<%= tag%>><<%= tag%>= msg.<%= inst%><%= tag%>><<%=
tag%>}<%= tag%>></span> <%}%> <% if(mod.cloums[inst].input.type=='editor'){%> <textarea
	class="cleditor" id="<%= inst%>" name="<%= inst%>" rows="3"><<%= tag%> if(inst!=null){<%= tag%>><<%= tag%>= inst.<%= inst%> <%= tag%>><<%= tag%> }<%= tag%>></textarea>
<span class="help-inline"><<%= tag%>if(msg!=null && msg.<%=
inst%>!=null){<%= tag%>><<%= tag%>= msg.<%= inst%><%= tag%>><<%=
tag%>}<%= tag%>></span> <%}%> <%
if(mod.cloums[inst].input.type=='checkboxes'){%> <% for(var ck in
mod.cloums[inst].checkboxes){%> <label class="checkbox inline">
<input type="checkbox" id="<%= inst%>_<%= ck%>" name="<%=
inst%>" value="<%= mod.cloums[inst].checkboxes[ck].value%>" <<%= tag%>
if(inst!=null && inst.<%= inst%>=='<%=
mod.cloums[inst].checkboxes[ck].value%>' ){<%= tag%>> checked='checked'
<<%= tag%> }<%= tag%>> /> <%= mod.cloums[inst].checkboxes[ck].name%> </label>
<%}%> <%}%> <% if(mod.cloums[inst].input.type=='radios'){%> <% for(var
rd in mod.cloums[inst].radios){%> <label class="radio"> <input
	type="radio" id="<%= inst%>_<%= rd%>" name="<%= inst%>"
value="<%= mod.cloums[inst].radios[rd].value%>" <<%= tag%> if(inst!=null
&& inst.<%= inst%>=='<%= mod.cloums[inst].radios[rd].value%>' ){<%=
tag%>> checked='checked' <<%= tag%> } else if(inst==null){<%= tag%>> <%=
mod.cloums[inst].radios[rd].checked%> <<%= tag%> }else{ <%= tag%>> <<%=
tag%> }<%= tag%>> /> <%= mod.cloums[inst].radios[rd].name%> </label> <%}%> <%}%>

<% if(mod.cloums[inst].input.type=='selects'){%> <select id="
	<%= inst%>" name="<%= inst%>" data-rel="chosen"> <% for(var sl in
	mod.cloums[inst].selects){%>
	<option value="<%= mod.cloums[inst].selects[sl].value%>"  <<%= tag%> if(inst!=null && inst.<%= inst%>=='<%= mod.cloums[inst].selects[sl].value%>' ){<%= tag%>> selected='selected'   <<%= tag%> } else if(inst==null){<%= tag%>>  <%= mod.cloums[inst].selects[sl].checked%>  <<%= tag%> }else{ <%= tag%>> <<%= tag%> }<%= tag%>> >
							 <%= mod.cloums[inst].selects[sl].name%> 
							</option> 
							<%}%>
								  </select> <%}%> <% if(mod.cloums[inst].input.type=='selectdb'){%> <select id="
	<%= inst%>" name="<%= inst%>" data-rel="chosen">
</select> <%}%> <% if(mod.cloums[inst].input.type=='selectdbGroup'){%> <select
	id="
	<%= inst%>" name="<%= inst%>" data-placeholder="请选择" data-rel="chosen">
	<option value=""></option> 
						     </select> <%}%> <% if(mod.cloums[inst].input.type=='selectajx'){%> <select id="
	<%= inst%>" name="<%= inst%>" data-rel="chosen">
</select> <%}%> <% if(mod.cloums[inst].input.type=='mutilselect'){%> <select id="
	<%= inst%>" name="<%= inst%>" multiple data-rel="chosen">
</select> <%}%></div>
</div>
<%}%>

<div class="form-actions">
<button type="submit" class="btn btn-primary">保存</button>
<button type="reset" class="btn">取消</button>
</div>
</fieldset>
</form>

</div>
</div>
<!--/span--></div>
<!--/row--></div>
<!-- div containt --> <script type="text/javascript">
<% for(var inst in mod.cloums){if(mod.cloums[inst].input.type=='selectdb'){%>
$(function(){
	 $.ajax(
	            {
	                url: '/selectdb/',
	                dataType: 'json',
	                type: 'POST',
	                async: false,
	                data:{tbname:'<%= mod.cloums[inst].selectdb.dbname%>',key:'<%= mod.cloums[inst].selectdb.key%>',value:'<%= mod.cloums[inst].selectdb.value%>'},
	                success: function (data, textStatus) {
	                	if(data.success)
                        {
                        	for (var i = 0; i < data.data.length; i++) {
                        		<<%= tag%>if(inst!=null){ <%= tag%>>
	                        if( data.data[i].<%= mod.cloums[inst].selectdb.key%>==<<%= tag%>= inst.<%= inst%><%= tag%>>)
	                        {
	                        	$("<option value='" + data.data[i].<%= mod.cloums[inst].selectdb.key%> + "' selected='selected' >" + data.data[i].<%= mod.cloums[inst].selectdb.value%> + "</option>").appendTo("#<%= inst%>");	
		                        }
	                        <<%= tag%>}else{<%= tag%>>
	                        if(false){}
	                        <<%= tag%>}<%= tag%>>
	                        else{
                        	$("<option value='" + data.data[i].<%= mod.cloums[inst].selectdb.key%> + "'  >" + data.data[i].<%= mod.cloums[inst].selectdb.value%> + "</option>").appendTo("#<%= inst%>");	
	                        }
                        	}
	                        }
	                        else{
	                        	alert(data.msg);
		                        }
	                },
	                error: function (XMLHttpRequest, textStatus, errorThrown) {
	                    alert('服务器访问发生异常！' + textStatus);
	                    return;
	                }

	            }
	            );	
	
});
<%}}%>

</script> <script type="text/javascript">
<% for(var inst in mod.cloums){if(mod.cloums[inst].input.type=='selectdbGroup'){%>
$(function(){
	 $.ajax(
	            {
	                url: '/selectdb/',
	                dataType: 'json',
	                type: 'POST',
	                async: false,
	                data:{tbname:'<%= mod.cloums[inst].selectdbGroup.dbname%>',key:'<%= mod.cloums[inst].selectdbGroup.key%>',value:'<%= mod.cloums[inst].selectdbGroup.value%>',groupby:'<%= mod.cloums[inst].selectdbGroup.groupby%>',groupdb:'<%= mod.cloums[inst].selectdbGroup.groupdb%>'},
	                success: function (data, textStatus) {
	                	if(data.success)
                        {
	                        var htmlappend='<option value=""></option> ';	                     
	                	
		                		for(var key in data.data){
		                	//$("<optgroup label='"+key+"'> ").appendTo("#<%= inst%>");	
		                	htmlappend+="<optgroup label='"+key+"'> ";
                        	for (var i = 0; i < data.data[key].length; i++) {
                        		<<%= tag%>if(inst!=null){ <%= tag%>>
	                        if( data.data[key][i].<%= mod.cloums[inst].selectdbGroup.key%>==<<%= tag%>= inst.<%= inst%><%= tag%>>)
	                        {
	                        	//$("<option value='" + data.data[key][i].<%= mod.cloums[inst].selectdbGroup.key%> + "' selected='selected' >" + data.data[key][i].<%= mod.cloums[inst].selectdbGroup.value%> + "</option>").appendTo("#<%= inst%>");	
	                        	htmlappend+="<option value='" + data.data[key][i].<%= mod.cloums[inst].selectdbGroup.key%> + "' selected='selected' >" + data.data[key][i].<%= mod.cloums[inst].selectdbGroup.value%> + "</option>";
		                        }
	                        <<%= tag%>}else{<%= tag%>>
	                        if(false){}
	                        <<%= tag%>}<%= tag%>>
	                        else{
                        	//$("<option value='" + data.data[key][i].<%= mod.cloums[inst].selectdbGroup.key%> + "'  >" + data.data[key][i].<%= mod.cloums[inst].selectdbGroup.value%> + "</option>").appendTo("#<%= inst%>");	
                        	htmlappend+="<option value='" + data.data[key][i].<%= mod.cloums[inst].selectdbGroup.key%> + "'  >" + data.data[key][i].<%= mod.cloums[inst].selectdbGroup.value%> + "</option>";
 	                        }
                        	}
                        	//$("</optgroup>").appendTo("#<%= inst%>");
                        	htmlappend+="</optgroup>";
	                		}
		                		$('#<%= inst%>').html(htmlappend);
	                		
                        	
	                        }
	                        
	                        else{
	                        	alert(data.msg);
		                        }
	                },
	                error: function (XMLHttpRequest, textStatus, errorThrown) {
	                    alert('服务器访问发生异常！' + textStatus);
	                    return;
	                }

	            }
	            );	
	
});

<%}}%>

</script>